var YA=function(){"use strict";var t=function(){this.initialize()};t.prototype={constructor:t,initialize:function(){this.data={},this.size=0},add:function(t,e){t in this.data||this.size++,this.data[t]=e},get:function(t){return this.data[t]},remove:function(t){t in this.data&&(delete this.data[t],this.size--)},addAll:function(e){if(e instanceof t)for(var r in e.data)this.add(r,e.get(r))},addAllIfNoExist:function(e){if(e instanceof t)for(var r in e.data)r in this.data||this.add(r,e.get(r))},containsKey:function(t){return t in this.data},containsValue:function(t){for(var e in this.data)if(this.get(e)===t)return!0;return!1},removeAll:function(e){if(e instanceof t)for(var r in e.data)this.remove(r)},toString:function(t){var e="",r="";for(var a in this.data)"act"!=a?(""!=e&&(e+="&"),e+=a+"="+(t?encodeURIComponent(this.data[a]):this.data[a])):r=this.data[a];return r&&(e="act="+r+"&"+e),e}};var e,r={trim:function(t){return t.replace(/(^\s*)|(\s*$)/g,"")},replaceBlank:function(t){var e=t.toString();return(e=(e=(e=e.replace(/ /g,"")).replace(/&nbsp;/g,"")).replace(/&/g,"|||")).replace(/r/g,"")},isNotBlank:function(t){return""!==this.trim(t)},contains:function(t,e){return t.indexOf(e)>-1},startWith:function(t,e){return!(!e||0===t.length||e.length>t.length)&&t.substring(0,e.length)===e},encode:function(t){return encodeURIComponent(t)},decode:function(t){return decodeURIComponent(t)},parseToInt:function(t){return isNaN(parseInt(t))?0:parseInt(t)},getQueryParam:function(e){var r=new t;if(!e)return r;for(var a=this.decode(e).replace("?","?&").split("&"),n=0;n<a.length;n++){var i=a[n].split("=");!i||i.length<2||r.add(i[0],i[1])}return r},getUrlDomain:function(t){if(!t)return document.domain;var e=t.match(/.*:\/\/([^/]*).*/),r="";return void 0!==e&&null!=e&&(r=e[1]),r},getURILocation:function(t){return this.isURL(t)?t.replace(/(.*\.[\w-]+\/){0,}([^?]+).*/gi,"$2"):""},isURL:function(t){return/^((http|https|ftp):\/\/)?(\w(:\w)?@)?([0-9a-z_-]+\.)*?([a-z0-9-]+\.[a-z]{2,6}(\.[a-z]{2})?(:[0-9]{2,6})?)((\/[^?#<>/\\*":]*)+(\?[^#]*)?(#.*)?)?$/i.test(t)},extractByCutPrefix:function(t,e){return t.substring(e.length,t.length)},getYaParamByPrefix:function(e,r,a){var n=new t;if(e)for(var i in e.data)this.startWith(i,r)?n.add(this.extractByCutPrefix(i,r),e.get(i)):a&&n.add(i,e.get(i));return n},consoleLog:function(t){try{console.log((new Date).format("yyyy-mm-dd HH:MM:ss")+" - "+t)}catch(t){}},isBlank:function(t){return!t||!/\S/.test(t)||"undefined"===t||"null"===t},addCookie:function(t,e,r){var a=t+"="+encodeURIComponent(e);if(r>0){var n=new Date;n.setTime(n.getTime()+3600*r*1e3),a+="; expires="+n.toUTCString()}a+="; path=/",document.cookie=a},delCookie:function(t){this.addCookie(t,"",1/3600)},getCookie:function(t){for(var e=document.cookie.split(""),r=0;r<e.length;r++){var a=e[r].replace("=","$=").split("$=");try{if(a[0]==t)return decodeURIComponent(a[1])}catch(e){if(a[0]==t)return unescape(a[1])}}return""},getStorage:function(t){try{return JSON.parse(localStorage.getItem(t))||JSON.parse(this.getCookie(t)||null)}catch(e){return this.isBlank(this.getCookie(t))?(console.log("e:"+e),null):JSON.parse(this.getCookie(t)||null)}},setStorage:function(t,e){try{this.isBlank(this.getStorage(t))||this.removeStorage(t),"string"==typeof e?window.localStorage.setItem(t,e):window.localStorage.setItem(t,JSON.stringify(e))}catch(r){console.log("e:"+r),this.addCookie(t,JSON.stringify(e))}},removeStorage:function(t){try{localStorage.removeItem(t)}catch(e){this.delCookie(t)}}};function a(t){return t?t.split(","):null}var n="https://ylog.nimo.tv",i=".nimo.tv";function o(){if(e)return e;var t=document.getElementById("yaScript");if(t){var r=t.getAttribute("pro"),o=t.getAttribute("data-ya-domain");e={pro:r,noreport:t.getAttribute("noreport"),pageviewext:t.getAttribute("pageviewext"),merge:t.getAttribute("merge"),domain:o||i,multiPro:t.getAttribute("multi-pro"),ylogOrigin:t.getAttribute("ylogorigin")||n}}else if(window.YA_SCRIPT_CONFIG){var s=window.YA_SCRIPT_CONFIG;e={pro:s.pro,pageviewext:s.pageviewext,domain:s.domain||i,noreport:s.noreport,merge:s.merge,multiPro:s.multiPro,ylogOrigin:s.ylogOrigin||n}}else e={pro:"",pageviewext:"",noreport:"",merge:"false",domain:i,ylogOrigin:n};return e.proList=a(e.multiPro),e}var s={init:"",cookieEnalned:"cookie"in document&&(document.cookie.length>0||(document.cookie="testCookieEnalned").indexOf.call(document.cookie,"testCookieEnalned")>-1),localStorageEnabled:function(){try{return window.localStorage&&(window.localStorage.setItem("testLocalStorageEnabled",123),123==window.localStorage.getItem("testLocalStorageEnabled"))}catch(t){return!1}}(),localCache:{},getCookie:function(t){if(!this.cookieEnalned)return this.getStorage(t);var e=document.cookie.match(RegExp("(^| )"+t+"=([^;]*)(;|$)"));return null!=e?r.decode(e[2]):null},getCookie_mid:function(t){return this.cookieEnalned?this.getCookie(t):this.getStorage(t)},getCookiesObj:function(){var t={};if(document.cookie){var e=document.cookie.split("; ");for(var r in e){var a=e[r].indexOf("="),n=e[r].substr(0,a),i=e[r].substr(a+1,e[r].length);t[n]=i}}return t},getCookieLength:function(){var t=this.getCookiesObj(),e=0;for(var r in t)e++;return e},getExpires:function(t){var e=new Date;return e.setTime(e.getTime()+t),e},deleteCookie:function(t){this.setCookie(t,"",0)},setCookie:function(t,e,a){if(this.cookieEnalned){var n=o().domain,i=t+"="+r.encode(e)+"; domain="+n+"; path=/";a>0&&(i+="; expires="+this.getExpires(a).toGMTString()),document.cookie=i}else this.setStorage(t,e)},setStorage:function(t,e){this.localStorageEnabled?window.localStorage.setItem(t,e):this.setLocalCache(t,e)},getStorage:function(t){return this.localStorageEnabled?window.localStorage.getItem(t):this.getLocalCache(t)},setLocalCache:function(t,e){this.localCache[t]=e},getLocalCache:function(t){return" __yamid_new"===t&&window.__yamid_new||this.localCache[t]}},d={generate32:function(){var t=new Date(1582,10,15,0,0,0,0),e=(new Date).getTime()-t.getTime();return this.generateBits(e,0,31)+""+this.generateBits(e,32,47)+this.generateBits(e,48,59)+"1"+this.generateBits(this.rand(4095),0,7)+this.generateBits(this.rand(4095),0,7)+(this.generateBits(this.rand(8191),0,7)+this.generateBits(this.rand(8191),8,15)+this.generateBits(this.rand(8191),0,7)+this.generateBits(this.rand(8191),8,15)+this.generateBits(this.rand(8191),0,15))},generateBits:function(t,e,r){var a=this.returnBase(t,16),n=[],i="",o=0;if(a&&a.length)for(o=0;o<a.length;o++)n.push(a.substring(o,o+1));for(o=Math.floor(e/4);o<=Math.floor(r/4);o++)n[o]&&""!=n[o]?i+=n[o]:i+="0";return i},returnBase:function(t,e){var r,a=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"];if(t<e)r=a[t];else{var n=""+Math.floor(t/e),i=t-n*e;r=n>=e?this.returnBase(n,e)+a[i]:a[n]+a[i]}return r},rand:function(t){return Math.floor(Math.random()*t)}},c=function(){var t=navigator.userAgent.toLowerCase(),e=navigator.platform,r="Win32"===e||"Windows"===e,a="Mac68K"===e||"MacPPC"===e||"Macintosh"===e||"MacIntel"===e,n=String(e).indexOf("Linux")>-1;if("iPhone"===e||"iPad"===e)return"iOS";if(a)return"Mac";if("X11"===e&&!r&&!a)return"Unix";if(n)return/android/.test(t)?"Android":"Linux";if(r){var i={ce:"WindowsMobile",mobile:"WindowsMobile","nt 5.0":"Windows2000","nt 5.1":"WindowsXP","nt 5.2":"Windows2003","nt 6.0":"WindowsVista","nt 6.1":"Windows7","nt 6.2":"Windows8","nt 10.0":"Windows10",2e3:"Windows2000",xp:"WindowsXP",2003:"Windows2003",vista:"WindowsVista",7:"Windows7",8:"Windows8",10:"Windows10"};for(var o in i)if(t.indexOf("windows "+o)>-1)return i[o]}return"unknown"},u=function(){var t,e="unknown",r=navigator.userAgent.toLowerCase();return((t=r.match(/msie ([\d.]+)/))||(t=r.match(/firefox\/([\d.]+)/))||(t=r.match(/yye\/([\d.]+)/))||(t=r.match(/chrome\/([\d.]+)/))||(t=r.match(/opera.([\d.]+)/))||(t=r.match(/version\/([\d.]+).*safari/)))&&(e=t[0]),e},h=function(){var t="0",e=navigator;if(e.plugins&&e.plugins.length){for(var a=0;a<e.plugins.length;a++)if(e.plugins[a].name&&-1!=e.plugins[a].name.indexOf("Shockwave Flash")){t=e.plugins[a].description.split("Shockwave Flash ")[1];break}}else if(window.ActiveXObject)for(var n=10;n>=2;n--)try{new window.ActiveXObject("ShockwaveFlash.ShockwaveFlash."+n),t=n+".0";break}catch(t){}return r.replaceBlank(t)},f={sdk_ver:"js-ya.huya-1.0",ap:navigator.appName,av:navigator.appVersion,ua:navigator.userAgent.toLowerCase(),cen:+!!navigator.cookieEnabled,jen:+!!navigator.javaEnabled(),lla:navigator.language?navigator.language:navigator.browserLanguage,sre:screen.width+"."+screen.height,sco:parseInt(screen.colorDepth)||parseInt(screen.pixelDepth),__yaParamPrex:"__ya",__yaOnerrorRetry:!1,__debug:!1,_yaDataCollectUrl:o().ylogOrigin+"/d.gif"},l={_yaHuyaTestCookieKey:"__yamid_tt1",_yaMidCookieKey:"__yamid_new",_yaSessionMid:"__yasmid",_yaMidCookieTimeout:63072e6,setConfig:function(t){for(var e in t)"function"!=typeof t[e]&&(f[e]=t[e])},getConfig:function(t){return f[t]},initConfig:function(t){this.referrer=document.referrer,this.refrerrerParam=r.getQueryParam(this.referrer),this.yaLocation=window.location,this.locationParam=r.getQueryParam(this.yaLocation),this.setYaConfigParam(t)},getYaParam:function(){return r.getYaParamByPrefix(this.locationParam,f.__yaParamPrex)},getBaseClientInfo:function(){if(this.baseParam)return this.baseParam;var e=new t;e.add("mid",this.getYamid(this.locationParam.get("mid"))),e.add("bve",u()),e.add("lla",f.lla),e.add("os",c()),e.add("sco",f.sco),e.add("sre",f.sre),e.add("fve",h()),e.add("jav",f.jen),e.add("coo",f.cen),e.add("domain",r.getUrlDomain()),e.add("fla","Y"),e.add("sdk_ver",f.sdk_ver);var a=this.getYaParam();return a.size>0&&e.addAll(a),this.yaConfigParam.size>0&&e.addAll(this.yaConfigParam),this.baseParam=e,this.baseParam},setYaConfigParam:function(e){var r=new t;if(e)for(var a in e)r.add(a,e[a]);r.containsKey("error_retry")&&(f.__yaOnerrorRetry=r.get("error_retry")),this.yaConfigParam=r},setYaMidCookie:function(t){t&&s.setCookie(this._yaMidCookieKey,t,this._yaMidCookieTimeout)},setSessionMid:function(t){t&&s.setCookie(this._yaSessionMid,t,-1)},getSessionMid:function(){return s.getCookie_mid(this._yaSessionMid)||""},storeSmid:function(t,e){var r=t;t&&t==e&&(r=e),t&&!e&&(this.setSessionMid(t),r=t),e||t||(t=Math.random(),this.setSessionMid(t),r=t),e&&!t&&(r=e),t&&e&&t!=e&&(r=e),window.HuyaYaTestSmid=r},getYamid:function(t){var e=s.getCookie_mid(this._yaMidCookieKey),r=s.getCookie_mid(this._yaHuyaTestCookieKey),a=this.getSessionMid();return this.storeSmid(r,a),e||(e=t||d.generate32(),this.setYaMidCookie(e),e)},doGetSend:function(t){var e=new Image(1,1);e.onload=function(){e=null},e.onerror=function(){e=null},e.src=t}},g=function(){this.init.apply(this,arguments)};g.prototype={constructor:g,init:function(t,e,r,a,n){l.initConfig(a),this.reportInstance=new t(e,r,n),this.reportInstance.createIntervalReport()},setParam:function(t,e){this.reportInstance.setParam.apply(this.reportInstance,arguments)},setExtParam:function(t){this.reportInstance.setExtParam.apply(this.reportInstance,arguments)},setAppMidParam:function(t){this.setExtParam("appmid="+t)},reportProductStartUp:function(t,e){this.reportInstance.reportStartUp.apply(this.reportInstance,arguments)},stopProductHeartbeat:function(t,e){this.reportInstance.stopHeartbeat.apply(this.reportInstance,arguments)},startProductHeartbeat:function(t,e){this.reportInstance.startHeartbeat.apply(this.reportInstance,arguments)},reportProductEndUp:function(t,e){this.reportInstance.reportEndUp.apply(this.reportInstance,arguments)},reportProductEvent:function(t,e){this.reportInstance.reportEvent.apply(this.reportInstance,arguments)},reportOneHeartbeat:function(t,e){this.reportInstance.oneHeartBeat.apply(this.reportInstance,arguments)}};var p=function(){function t(t){return""==t?t:function(t){for(var r,a=e?"0123456789ABCDEF":"0123456789abcdef",n="",i=0;i<t.length;i++)r=t.charCodeAt(i),n+=a.charAt(r>>>4&15)+a.charAt(15&r);return n}(function(t){for(var e=function(t,e){t[e>>5]|=128<<e%32,t[14+(e+64>>>9<<4)]=e;for(var r=0x67452301,d=-0x10325477,c=-0x67452302,u=0x10325476,h=0;h<t.length;h+=16){var f=r,l=d,g=c,p=u;r=a(r,d,c,u,t[h+0],7,-0x28955b88),u=a(u,r,d,c,t[h+1],12,-0x173848aa),c=a(c,u,r,d,t[h+2],17,0x242070db),d=a(d,c,u,r,t[h+3],22,-0x3e423112),r=a(r,d,c,u,t[h+4],7,-0xa83f051),u=a(u,r,d,c,t[h+5],12,0x4787c62a),c=a(c,u,r,d,t[h+6],17,-0x57cfb9ed),d=a(d,c,u,r,t[h+7],22,-0x2b96aff),r=a(r,d,c,u,t[h+8],7,0x698098d8),u=a(u,r,d,c,t[h+9],12,-0x74bb0851),c=a(c,u,r,d,t[h+10],17,-42063),d=a(d,c,u,r,t[h+11],22,-0x76a32842),r=a(r,d,c,u,t[h+12],7,0x6b901122),u=a(u,r,d,c,t[h+13],12,-0x2678e6d),c=a(c,u,r,d,t[h+14],17,-0x5986bc72),r=n(r,d=a(d,c,u,r,t[h+15],22,0x49b40821),c,u,t[h+1],5,-0x9e1da9e),u=n(u,r,d,c,t[h+6],9,-0x3fbf4cc0),c=n(c,u,r,d,t[h+11],14,0x265e5a51),d=n(d,c,u,r,t[h+0],20,-0x16493856),r=n(r,d,c,u,t[h+5],5,-0x29d0efa3),u=n(u,r,d,c,t[h+10],9,0x2441453),c=n(c,u,r,d,t[h+15],14,-0x275e197f),d=n(d,c,u,r,t[h+4],20,-0x182c0438),r=n(r,d,c,u,t[h+9],5,0x21e1cde6),u=n(u,r,d,c,t[h+14],9,-0x3cc8f82a),c=n(c,u,r,d,t[h+3],14,-0xb2af279),d=n(d,c,u,r,t[h+8],20,0x455a14ed),r=n(r,d,c,u,t[h+13],5,-0x561c16fb),u=n(u,r,d,c,t[h+2],9,-0x3105c08),c=n(c,u,r,d,t[h+7],14,0x676f02d9),r=i(r,d=n(d,c,u,r,t[h+12],20,-0x72d5b376),c,u,t[h+5],4,-378558),u=i(u,r,d,c,t[h+8],11,-0x788e097f),c=i(c,u,r,d,t[h+11],16,0x6d9d6122),d=i(d,c,u,r,t[h+14],23,-0x21ac7f4),r=i(r,d,c,u,t[h+1],4,-0x5b4115bc),u=i(u,r,d,c,t[h+4],11,0x4bdecfa9),c=i(c,u,r,d,t[h+7],16,-0x944b4a0),d=i(d,c,u,r,t[h+10],23,-0x41404390),r=i(r,d,c,u,t[h+13],4,0x289b7ec6),u=i(u,r,d,c,t[h+0],11,-0x155ed806),c=i(c,u,r,d,t[h+3],16,-0x2b10cf7b),d=i(d,c,u,r,t[h+6],23,0x4881d05),r=i(r,d,c,u,t[h+9],4,-0x262b2fc7),u=i(u,r,d,c,t[h+12],11,-0x1924661b),c=i(c,u,r,d,t[h+15],16,0x1fa27cf8),r=o(r,d=i(d,c,u,r,t[h+2],23,-0x3b53a99b),c,u,t[h+0],6,-0xbd6ddbc),u=o(u,r,d,c,t[h+7],10,0x432aff97),c=o(c,u,r,d,t[h+14],15,-0x546bdc59),d=o(d,c,u,r,t[h+5],21,-0x36c5fc7),r=o(r,d,c,u,t[h+12],6,0x655b59c3),u=o(u,r,d,c,t[h+3],10,-0x70f3336e),c=o(c,u,r,d,t[h+10],15,-1051523),d=o(d,c,u,r,t[h+1],21,-0x7a7ba22f),r=o(r,d,c,u,t[h+8],6,0x6fa87e4f),u=o(u,r,d,c,t[h+15],10,-0x1d31920),c=o(c,u,r,d,t[h+6],15,-0x5cfebcec),d=o(d,c,u,r,t[h+13],21,0x4e0811a1),r=o(r,d,c,u,t[h+4],6,-0x8ac817e),u=o(u,r,d,c,t[h+11],10,-0x42c50dcb),c=o(c,u,r,d,t[h+2],15,0x2ad7d2bb),d=o(d,c,u,r,t[h+9],21,-0x14792c6f),r=s(r,f),d=s(d,l),c=s(c,g),u=s(u,p)}return[r,d,c,u]}(function(t){for(var e=Array(t.length>>2),r=0;r<e.length;r++)e[r]=0;for(var a=0;a<8*t.length;a+=8)e[a>>5]|=(255&t.charCodeAt(a/8))<<a%32;return e}(t),8*t.length),r="",d=0;d<32*e.length;d+=8)r+=String.fromCharCode(e[d>>5]>>>d%32&255);return r}(function(t){for(var e,r,a="",n=-1;++n<t.length;)e=t.charCodeAt(n),r=n+1<t.length?t.charCodeAt(n+1):0,55296<=e&&e<=56319&&56320<=r&&r<=57343&&(e=65536+((1023&e)<<10)+(1023&r),n++),e<=127?a+=String.fromCharCode(e):e<=2047?a+=String.fromCharCode(192|e>>>6&31,128|63&e):e<=65535?a+=String.fromCharCode(224|e>>>12&15,128|e>>>6&63,128|63&e):e<=2097151&&(a+=String.fromCharCode(240|e>>>18&7,128|e>>>12&63,128|e>>>6&63,128|63&e));return a}(t)))}var e=0;function r(t,e,r,a,n,i){var o;return s((o=s(s(e,t),s(a,i)))<<n|o>>>32-n,r)}function a(t,e,a,n,i,o,s){return r(e&a|~e&n,t,e,i,o,s)}function n(t,e,a,n,i,o,s){return r(e&n|a&~n,t,e,i,o,s)}function i(t,e,a,n,i,o,s){return r(e^a^n,t,e,i,o,s)}function o(t,e,a,n,i,o,s){return r(a^(e|~n),t,e,i,o,s)}function s(t,e){var r=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(r>>16)<<16|65535&r}return t.noConflict=function(){return t},t}(),m=function(){this.init()};m.prototype={constructor:m,reportTimerPeriod:1e3,reportSDataTimerPeriod:144e5,init:function(){},queuePush:function(t,e,r,a){return this.doSendData(l.getConfig("_yaDataCollectUrl")+"?",t,e,r,a)},doSendData:function(e,r,a,n,i){if(r.get("_ya_customReport"))return r.remove("_ya_customReport"),o=r.toString(!0),void this.newImage(e,a,n||this.errorCallback,o);r.add("rid","ods_action_log"),r.get("furl")||r.add("furl",document.referrer),r.get("curl")||r.add("curl",encodeURIComponent(window.location.href)),r.add("__yafm","i"),r.add("ati","");var o,s=r.get("pro"),d=[r];if(Array.isArray(i))for(var c=0;c<i.length;c++){var u=i[c];if(u&&s!==u){var h=new t;h.addAll(r),h.add("pro",u),d.push(h)}}for(var f=0;f<d.length;f++){var l=d[f],g=this.getQueryMd5(l.data);l.add("auth_key",g),l.remove("__yafm"),l.remove("ati");var p=l.get("act");p&&l.remove("act"),o="act="+p+"&"+l.toString(!0)+"&__yafm=i&ati=",this.newImage(e,a,n||this.errorCallback,o)}},localStorageEnabled:function(){try{return window.localStorage&&(window.localStorage.setItem("testLocalStorageEnabled",123),123==window.localStorage.getItem("testLocalStorageEnabled"))}catch(t){return!1}}(),newImage:function(t,e,r,a){if("true"===o().merge&&this.localStorageEnabled)this.saveMergeReport(a,e);else{var n=new Image(1,1);n.onload=function(){n.onload=null,n=null,e&&e(a)},n.src=t+a}},initBeforeunload:function(){this.huyaMergeReport()},saveMergeReport:function(t,e){try{var a=r.getStorage("reportArr")||[],n='{"'+t.replace(/&/g,'","').replace(/=/g,'":"')+'"}',i=JSON.parse(n);for(var o in i)i[o]=decodeURIComponent(i[o]),"ua"!==o&&"curl"!==o&&"furl"!==o||(i[o]=decodeURIComponent(i[o]));a.push(JSON.stringify(i)),r.setStorage("reportArr",a),e&&e(t)}catch(t){console.log(t)}},huyaMergeReport:function(){var t=r.getStorage("reportArr")||[];if(0!==t.length){var e=o().ylogOrigin+"/g.gif";if(navigator.sendBeacon&&navigator.sendBeacon(e,"["+t+"]"))return void r.setStorage("reportArr",[]);var a=new XMLHttpRequest;a.open("POST",e),a.timeout=3e3,a.setRequestHeader("Content-Type","application/json"),a.onload=function(){200!=this.status&&304!=this.status||r.setStorage("reportArr",[])},a.send("["+t+"]")}},callback:function(t){},errorCallback:function(t){},getQueryMd5:function(t){var e=this.getObjKey(t);e.sort();var r=this.getMd5Data(e,t),a=parseInt((new Date).getTime()/1e3)+300,n=parseInt(1e5*Math.random());return a+"-"+n+"-"+p(a+"-"+r+"-"+n)},getMd5Data:function(t,e){for(var r,a="",n=0;r=t[n];n++)a+=r+e[r];return a},getObjKey:function(t){var e=[];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.push(r);return e}};var v=new m,y=!1,w=function(){};w.extend=function t(e){var r=null;function a(){y||(r&&(this._superprototype=r.prototype),this.init.apply(this,arguments))}for(var n in this!==w&&(r=this),r&&(y=!0,a.prototype=new r,a.prototype.constructor=a,y=!1),a.extend=t,e)Object.prototype.hasOwnProperty.call(e,n)&&(r&&"function"==typeof e[n]&&"function"==typeof a.prototype[n]&&/\b_super\b/.test(e[n])?a.prototype[n]=function(t,e){return function(){return this._super=r.prototype[t],e.apply(this,arguments)}}(n,e[n]):a.prototype[n]=e[n]);return a};var C=w.extend({init:function(e,r,a){if(this.param=new t,r&&this.param.add("pro",r),a&&this.param.add("pas",a),!e)throw Error("please input the dty");this.param.add("dty",e),window.addEventListener("beforeunload",v.initBeforeunload.bind(v))},setExtParam:function(t){if(t){var e=r.getYaParamByPrefix(r.getQueryParam(t),l.getConfig("__yaParamPrex"),!0);this.param.addAll(e)}},getPasParam:function(e,a){var n=new t;if(n.addAll(this.param),e)for(var i in e)n.add(i,e[i]);return n.addAll(r.getQueryParam(a)),n}}),S=function(t){this.initialize(t)};S.defaultPeriodTime=3e5,S.prototype={constructor:S,intervalCounter:0,initialize:function(t){this.periodTime=3e5,this.startTime=new Date,t&&/^[1-9]+[0-9]*$/.test(t)&&(this.periodTime=t)},doInterval:function(t){var e=this;if(!t)throw Error("pleace pass callback");var r=function(){e.sh=window.setTimeout(function(){t&&t.call(e),r()},e.periodTime)};r()},clearRefresh:function(){clearTimeout(this.sh)}};var x={defaultSessionIdKey:"product",_yasdatas:"_yasdatas_",_yasids:"_yasids",sessionIds:new t,sDataQueue:[],separator:"\x01",add:function(e,a,n){var i=r.getQueryParam(a),o=new t;for(var d in{pro:"",cha:"",rso:""})o.add(d,i.get(d));var c=new t;c.add(e,a),this.sDataQueue.push(c),1==n&&s.setCookie(this._yasdatas+e,o.toString(),-1)},get:function(e){for(var r=null,a=0;a<this.sDataQueue.length;a++)this.sDataQueue[a]instanceof t&&this.sDataQueue[a].containsKey(e)&&(r=this.sDataQueue[a]);if(r instanceof t)return r.get(e);if(null==r){var n=this.getCCParam(this._yasdatas+e);n&&n.size>1&&(n.add("act","/session_data"),n.add("session_id",e),n.addAll(l.getBaseClientInfo()),this.add(e,n.toString()),r=n.toString())}return r},getCCParam:function(t){return r.getQueryParam(this.getCCValue(t))},getCCValue:function(t){return s.getCookie(t)},generateSessionId:function(e,r){var a=e?e.toLowerCase():this.defaultSessionIdKey,n=d.generate32();if(this.sessionIds.add(a,n),1==r){var i=this.getCCParam(this._yasids);i||(i=new t),i.add(a,n),s.setCookie(this._yasids,i.toString(),-1)}return n},getSessionId:function(t,e){var r=t?t.toLowerCase():this.defaultSessionIdKey,a=this.sessionIds.get(r);return a&&!e||(a=this.getCCParam(this._yasids).get(r))&&this.sessionIds.add(r,a),a},getSessionIdAndGenIfNotExist:function(t,e,r){var a=this.getSessionId(t,r);return a||(a=this.generateSessionId(t,e)),a}},_="ROOT",b={},I=C.extend({init:function(t,e,r){this.rootSidKey="__rootSid",this.sdkVer="js-ya.huya-1.0",this.heartbeatPeriodTime=6e4,this.initPageType(),this.dty="live";var n=Array.apply(this,arguments);this.proList=a(r&&r.multiPro),n.unshift(this.dty),this._super.apply(this,n),this.initSessionData()},initPageType:function(){var t=(l.yaConfigParam.get("pageType")||"").toUpperCase();if(_!==t&&"SUB"!==t)throw Error("please input the pageType (ROOT / SUB)");this.pageType=t},reportStartUp:function(t,e){var r=this.getReportParam(t,e);r.add("eid","startup"),r.add("eid_desc","会话启动");try{r.add("ua",encodeURIComponent(navigator.userAgent))}catch(t){}b.startup=r,this.reportBaseEvent(r),this.heartBeatDur=(new Date).getTime()},createIntervalReport:function(){"true"===o().merge&&(this.intervalReportTimer=new S(3e3),this.intervalReportTimer.doInterval(function(){v.huyaMergeReport()}))},reportBaseEvent:function(t){t.add("act","/event"),t.add("session_id",this.getSid()),v.queuePush(t,null,null,this.proList)},oneHeartBeat:function(t,e){var r=this.getReportParam(t,e);r.add("eid","heartbeat"),r.add("eid_desc","心跳"),r.add("dur",this.getDur()),this.reportBaseEvent(r)},startHeartbeat:function(t,e){var r=this;this.heartBeatTimer=new S(this.heartbeatPeriodTime),this.heartBeatTimer.doInterval(function(){var a=r.getReportParam(t,e);a.add("eid","heartbeat"),a.add("eid_desc","心跳"),a.add("dur",r.getDur()),r.reportBaseEvent(a)})},stopHeartbeat:function(){this.heartBeatTimer.clearRefresh()},reportEndUp:function(t,e){var r=this.getReportParam(t,e);r.add("eid","endup"),r.add("eid_desc","会话结束"),r.add("dur",this.getDur()),this.reportBaseEvent(r)},getDur:function(){return this.heartBeatDur||(this.heartBeatDur=(new Date).getTime()),(new Date).getTime()-this.heartBeatDur},initSessionData:function(){this.clientInfo=l.getBaseClientInfo(),this.sessionData=new t,this.sessionData.addAll(this.clientInfo),this.sessionData.addAll(this.param),this.sessionData.add("yyuid",l.yaConfigParam.get("yyuid")||""),this.sessionData.add("sdk_ver",this.sdkVer);var e=this.validAlwaysNew();this.initSessionId(e)},validAlwaysNew:function(){var t=!1,e=s.getCookie("__yaoldyyuid"),r=s.getCookie("yyuid");return null==e&&(e=""),null==r&&(r=""),e!==r&&(t=!0,s.setCookie("__yaoldyyuid",r||"")),t},initSessionId:function(t){this.sidKey=this.pageType===_?this.rootSidKey:this.generalSubSidKey();var e="";e=t?x.generateSessionId(this.sidKey,!0):x.getSessionIdAndGenIfNotExist(this.sidKey,!1,!0),this.sessionData.add("session_id",e)},reportEvent:function(t,e){var r=this.getReportParam(t,e);r.add("dur",this.getDur()),this.reportBaseEvent(r)},generalSubSidKey:function(){return"sub_"+p(location.host+location.pathname)},getSid:function(){var t=x.getSessionIdAndGenIfNotExist(this.rootSidKey,!0,!0),e=l.yaConfigParam.get("session_id");return this.pageType===_?e||t:e?t+"/"+e:t+"/"+x.getSessionId(this.sidKey)},checkIsRoot:function(){for(var t,e=this.rootProUrlMap,r=location.href,a=0;t=e[a];a++)if(t===r)return void(this.pageType=_);this.pageType="SUB"},getReportParam:function(t,e){var r=this.getPasParam(t,e);return this.megerParamWithSessionData(r)},megerParamWithSessionData:function(e){var r=new t;return r.addAll(this.sessionData),r.addAll(e),r}});I.static={},I.static.pageViewReport=function(){var e=o(),a=e.pro,n=e.noreport,i=e.pageviewext,s=e.proList;if("true"!=n){var d={};if(i)for(var c,u=i.split("&"),h=0;c=u[h];h++){var f=c.split("=");d[f[0]]=encodeURIComponent(f[1])}l.initConfig();var g=l.getBaseClientInfo();for(var p in g.add("session_id",x.getSessionIdAndGenIfNotExist("__rootSid",!0,!0)),g.add("curl",encodeURIComponent(location.href)),g.add("furl",document.referrer),g.add("pro",a),g.add("act","/event"),g.add("dty","outlive"),d)g.add(p,d[p]);var m=new t;m.addAll(g),m.add("eid","pageview"),m.add("eid_desc","页面预览");try{m.add("ua",encodeURIComponent(navigator.userAgent))}catch(t){}var y="";if(b.startup&&b.startup.data&&b.startup.data.rso)y=b.startup.data.rso;else{var w=r.getQueryParam(location);w.data.rso?y=w.data.rso:w.data.from&&(y=w.data.from)}y&&m.add("rso",y),v.queuePush(m,null,null,s)}},I.static.getMid=function(){return l.getYamid()},I.static.customReport=function(e){e._ya_customReport=!0;var r=new t;for(var a in e)r.add(a,e[a]);v.queuePush(r)};var P=function(t,e,r,a){if(!t)throw Error("please input the product");e||(e="");var n=new g(I,t,e,r,a);return P.yaInstance=n,n};return P.cookie={},P.cookie.get=function(){return s.getCookie.apply(s,arguments)},P.session_id={},P.session_id.get=function(){return P.yaInstance.reportInstance.getSid()},P.customReport=function(t){return I.static.customReport(t)},P.mid={},P.mid.get=function(){return I.static.getMid()},P.static={},P.static.pageViewReport=function(){return I.static.pageViewReport()},window.G_DISABLE_AUTO_PAGEREPORT||setTimeout(function(){P.static.pageViewReport()},10),P}();